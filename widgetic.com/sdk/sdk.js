!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(a,c){b.exports=c()}(this,function(){"use strict";var a={},b=function(){var a=!1;return function(b){return function(){a||(a=!0,b.apply(null,arguments))}}},c=function(a){var b=a&&a.then;return"object"==typeof a&&"function"==typeof b?function(){return b.apply(a,arguments)}:void 0},d=function(b,c){var d=a.defer(),e=function(a,b){setTimeout(function(){var c;try{c=a(b)}catch(e){return void d.reject(e)}c===d.promise?d.reject(new TypeError("Cannot resolve promise with itself")):d.resolve(c)},1)},g=function(a){b&&b.call?e(b,a):d.resolve(a)},h=function(a){c&&c.call?e(c,a):d.reject(a)};return{promise:d.promise,handle:function(a,b){a===f?g(b):h(b)}}},e=0,f=1,g=2;return a.defer=function(){var a,h=e,i=[],j=function(b,c){h=b,a=c,i.forEach(function(b){b.handle(h,a)}),i=null},k=function(a){j(f,a)},l=function(a){j(g,a)},m=function(b,c){var f=d(b,c);return h===e?i.push(f):f.handle(h,a),f.promise},n=function(a){var c=b();try{a(c(o),c(l))}catch(d){c(l)(d)}},o=function(a){var b;try{b=c(a)}catch(d){return void l(d)}b?n(b):k(a)},p=b();return{resolve:p(o),reject:p(l),promise:{then:m,fail:function(a){return m(null,a)}}}},a})},{}],2:[function(a,b,c){!function(a){"use strict";function c(){var b={},c=Function;return{publish:function(){var c,d,e,f=arguments,g=b[f[0]];g&&(c=g.length,d=f.length>1?Array.prototype.splice.call(f,1):[],setTimeout(function(){for(e=0;c>e;e+=1)g[e].apply(a,d);g=a=d=null},0))},subscribe:function(a,d){if("string"!=typeof a)throw"invalid or missing channel";if(!(d instanceof c))throw"invalid or missing callback";return b[a]||(b[a]=[]),b[a].push(d),{channel:a,callback:d}},unsubscribe:function(a,d){if(a.channel&&a.callback&&(d=a.callback,a=a.channel),"string"!=typeof a)throw"invalid or missing channel";if(!(d instanceof c))throw"invalid or missing callback";var e,f=b[a],g=f instanceof Array?f.length:0;for(e=0;g>e;e+=1)if(f[e]===d){f.splice(e,1);break}}}}b.exports=c()}(this)},{}],3:[function(a,b,c){!function(){function a(a){function b(){for(;h=k<j.length&&a>l;){var b=k++,c=j[b],f=d.call(c,1);f.push(e(b)),++l,c[0].apply(null,f)}}function e(a){return function(c,d){--l,null==n&&(null!=c?(n=c,k=m=NaN,f()):(j[a]=d,--m?h||b():f()))}}function f(){null!=n?o(n):i?o(n,j):o.apply(null,[n].concat(j))}var g,h,i,j=[],k=0,l=0,m=0,n=null,o=c;return a||(a=1/0),g={defer:function(){return n||(j.push(arguments),++m,b()),g},awaitz:function(a){return o=a,i=!1,m||f(),g},awaitzAll:function(a){return o=a,i=!0,m||f(),g}}}function c(){}var d=[].slice;a.version="1.0.8","object"==typeof b&&b.exports?b.exports=a:"function"==typeof define&&define.amd?define(function(){return a}):this.queue=a}()},{}],4:[function(a,b,c){!function(a,d){"object"==typeof c?b.exports=d():"function"==typeof define&&define.amd?define("uxhr",d):a.uxhr=d()}(this,function(){"use strict";return function(a,b,c){b=b||"",c=c||{};var d=c.complete||function(){},e=c.success||function(){},f=c.error||function(){},g=c.headers||{},h=c.method||"GET",i=c.sync||!1,j=function(){return 0===a.indexOf("http")&&"undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest}();if(!j)throw new Error("Browser doesn't support XHR");if("string"!=typeof b){var k=[];for(var l in b)k.push(l+"="+b[l]);b=k.join("&")}"ontimeout"in j&&(j.ontimeout=+c.timeout||0),j.onload=function(){d(j.responseText,j.status),e(j.responseText)},j.onerror=function(){d(j.responseText),f(j.responseText,j.status)},j.open(h,"GET"===h&&b?a+"?"+b:a,!i);for(var m in g)j.setRequestHeader(m,g[m]);return j.send("GET"!==h?b:null),j}})},{}],5:[function(a,b,c){!function(a){function b(a){if(b[a]!==f)return b[a];var c;if("bug-string-char-index"==a)c="a"!="a"[0];else if("json"==a)c=b("json-stringify")&&b("json-parse");else{var d,e='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==a){var h=j.stringify,i="function"==typeof h&&k;if(i){(d=function(){return 1}).toJSON=d;try{i="0"===h(0)&&"0"===h(new Number)&&'""'==h(new String)&&h(g)===f&&h(f)===f&&h()===f&&"1"===h(d)&&"[1]"==h([d])&&"[null]"==h([f])&&"null"==h(null)&&"[null,null,null]"==h([f,g,null])&&h({a:[d,!0,!1,null,"\x00\b\n\f\r	"]})==e&&"1"===h(null,d)&&"[\n 1,\n 2\n]"==h([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==h(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==h(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==h(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==h(new Date(-1))}catch(l){i=!1}}c=i}if("json-parse"==a){var m=j.parse;if("function"==typeof m)try{if(0===m("0")&&!m(!1)){d=m(e);var n=5==d.a.length&&1===d.a[0];if(n){try{n=!m('"	"')}catch(l){}if(n)try{n=1!==m("01")}catch(l){}if(n)try{n=1!==m("1.")}catch(l){}}}}catch(l){n=!1}c=n}}return b[a]=!!c}var d,e,f,g={}.toString,h="function"==typeof define&&define.amd,i="object"==typeof JSON&&JSON,j="object"==typeof c&&c&&!c.nodeType&&c;j&&i?(j.stringify=i.stringify,j.parse=i.parse):j=a.JSON=i||{};var k=new Date(-0xc782b5b800cec);try{k=-109252==k.getUTCFullYear()&&0===k.getUTCMonth()&&1===k.getUTCDate()&&10==k.getUTCHours()&&37==k.getUTCMinutes()&&6==k.getUTCSeconds()&&708==k.getUTCMilliseconds()}catch(l){}if(!b("json")){var m="[object Function]",n="[object Date]",o="[object Number]",p="[object String]",q="[object Array]",r="[object Boolean]",s=b("bug-string-char-index");if(!k)var t=Math.floor,u=[0,31,59,90,120,151,181,212,243,273,304,334],v=function(a,b){return u[b]+365*(a-1970)+t((a-1969+(b=+(b>1)))/4)-t((a-1901+b)/100)+t((a-1601+b)/400)};(d={}.hasOwnProperty)||(d=function(a){var b,c={};return(c.__proto__=null,c.__proto__={toString:1},c).toString!=g?d=function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(b=c.constructor,d=function(a){var c=(this.constructor||b).prototype;return a in this&&!(a in c&&this[a]===c[a])}),c=null,d.call(this,a)});var w={"boolean":1,number:1,string:1,undefined:1},x=function(a,b){var c=typeof a[b];return"object"==c?!!a[b]:!w[c]};if(e=function(a,b){var c,f,h,i=0;(c=function(){this.valueOf=0}).prototype.valueOf=0,f=new c;for(h in f)d.call(f,h)&&i++;return c=f=null,i?e=2==i?function(a,b){var c,e={},f=g.call(a)==m;for(c in a)f&&"prototype"==c||d.call(e,c)||!(e[c]=1)||!d.call(a,c)||b(c)}:function(a,b){var c,e,f=g.call(a)==m;for(c in a)f&&"prototype"==c||!d.call(a,c)||(e="constructor"===c)||b(c);(e||d.call(a,c="constructor"))&&b(c)}:(f=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],e=function(a,b){var c,e,h=g.call(a)==m,i=!h&&"function"!=typeof a.constructor&&x(a,"hasOwnProperty")?a.hasOwnProperty:d;for(c in a)h&&"prototype"==c||!i.call(a,c)||b(c);for(e=f.length;c=f[--e];i.call(a,c)&&b(c));}),e(a,b)},!b("json-stringify")){var y={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},z="000000",A=function(a,b){return(z+(b||0)).slice(-a)},B="\\u00",C=function(a){var b,c='"',d=0,e=a.length,f=e>10&&s;for(f&&(b=a.split(""));e>d;d++){var g=a.charCodeAt(d);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:c+=y[g];break;default:if(32>g){c+=B+A(2,g.toString(16));break}c+=f?b[d]:s?a.charAt(d):a[d]}}return c+'"'},D=function(a,b,c,h,i,j,k){var l,m,s,u,w,x,y,z,B,E,F,G,H,I,J,K;try{l=b[a]}catch(L){}if("object"==typeof l&&l)if(m=g.call(l),m!=n||d.call(l,"toJSON"))"function"==typeof l.toJSON&&(m!=o&&m!=p&&m!=q||d.call(l,"toJSON"))&&(l=l.toJSON(a));else if(l>-1/0&&1/0>l){if(v){for(w=t(l/864e5),s=t(w/365.2425)+1970-1;v(s+1,0)<=w;s++);for(u=t((w-v(s,0))/30.42);v(s,u+1)<=w;u++);w=1+w-v(s,u),x=(l%864e5+864e5)%864e5,y=t(x/36e5)%24,z=t(x/6e4)%60,B=t(x/1e3)%60,E=x%1e3}else s=l.getUTCFullYear(),u=l.getUTCMonth(),w=l.getUTCDate(),y=l.getUTCHours(),z=l.getUTCMinutes(),B=l.getUTCSeconds(),E=l.getUTCMilliseconds();l=(0>=s||s>=1e4?(0>s?"-":"+")+A(6,0>s?-s:s):A(4,s))+"-"+A(2,u+1)+"-"+A(2,w)+"T"+A(2,y)+":"+A(2,z)+":"+A(2,B)+"."+A(3,E)+"Z"}else l=null;if(c&&(l=c.call(b,a,l)),null===l)return"null";if(m=g.call(l),m==r)return""+l;if(m==o)return l>-1/0&&1/0>l?""+l:"null";if(m==p)return C(""+l);if("object"==typeof l){for(I=k.length;I--;)if(k[I]===l)throw TypeError();if(k.push(l),F=[],J=j,j+=i,m==q){for(H=0,I=l.length;I>H;H++)G=D(H,l,c,h,i,j,k),F.push(G===f?"null":G);K=F.length?i?"[\n"+j+F.join(",\n"+j)+"\n"+J+"]":"["+F.join(",")+"]":"[]"}else e(h||l,function(a){var b=D(a,l,c,h,i,j,k);b!==f&&F.push(C(a)+":"+(i?" ":"")+b)}),K=F.length?i?"{\n"+j+F.join(",\n"+j)+"\n"+J+"}":"{"+F.join(",")+"}":"{}";return k.pop(),K}};j.stringify=function(a,b,c){var d,e,f,h;if("function"==typeof b||"object"==typeof b&&b)if((h=g.call(b))==m)e=b;else if(h==q){f={};for(var i,j=0,k=b.length;k>j;i=b[j++],h=g.call(i),(h==p||h==o)&&(f[i]=1));}if(c)if((h=g.call(c))==o){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else h==p&&(d=c.length<=10?c:c.slice(0,10));return D("",(i={},i[""]=a,i),e,f,d,"",[])}}if(!b("json-parse")){var E,F,G=String.fromCharCode,H={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},I=function(){throw E=F=null,SyntaxError()},J=function(){for(var a,b,c,d,e,f=F,g=f.length;g>E;)switch(e=f.charCodeAt(E)){case 9:case 10:case 13:case 32:E++;break;case 123:case 125:case 91:case 93:case 58:case 44:return a=s?f.charAt(E):f[E],E++,a;case 34:for(a="@",E++;g>E;)if(e=f.charCodeAt(E),32>e)I();else if(92==e)switch(e=f.charCodeAt(++E)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:a+=H[e],E++;break;case 117:for(b=++E,c=E+4;c>E;E++)e=f.charCodeAt(E),e>=48&&57>=e||e>=97&&102>=e||e>=65&&70>=e||I();a+=G("0x"+f.slice(b,E));break;default:I()}else{if(34==e)break;for(e=f.charCodeAt(E),b=E;e>=32&&92!=e&&34!=e;)e=f.charCodeAt(++E);a+=f.slice(b,E)}if(34==f.charCodeAt(E))return E++,a;I();default:if(b=E,45==e&&(d=!0,e=f.charCodeAt(++E)),e>=48&&57>=e){for(48==e&&(e=f.charCodeAt(E+1),e>=48&&57>=e)&&I(),d=!1;g>E&&(e=f.charCodeAt(E),e>=48&&57>=e);E++);if(46==f.charCodeAt(E)){for(c=++E;g>c&&(e=f.charCodeAt(c),e>=48&&57>=e);c++);c==E&&I(),E=c}if(e=f.charCodeAt(E),101==e||69==e){for(e=f.charCodeAt(++E),(43==e||45==e)&&E++,c=E;g>c&&(e=f.charCodeAt(c),e>=48&&57>=e);c++);c==E&&I(),E=c}return+f.slice(b,E)}if(d&&I(),"true"==f.slice(E,E+4))return E+=4,!0;if("false"==f.slice(E,E+5))return E+=5,!1;if("null"==f.slice(E,E+4))return E+=4,null;I()}return"$"},K=function(a){var b,c;if("$"==a&&I(),"string"==typeof a){if("@"==(s?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];a=J(),"]"!=a;c||(c=!0))c&&(","==a?(a=J(),"]"==a&&I()):I()),","==a&&I(),b.push(K(a));return b}if("{"==a){for(b={};a=J(),"}"!=a;c||(c=!0))c&&(","==a?(a=J(),"}"==a&&I()):I()),(","==a||"string"!=typeof a||"@"!=(s?a.charAt(0):a[0])||":"!=J())&&I(),b[a.slice(1)]=K(J());return b}I()}return a},L=function(a,b,c){var d=M(a,b,c);d===f?delete a[b]:a[b]=d},M=function(a,b,c){var d,f=a[b];if("object"==typeof f&&f)if(g.call(f)==q)for(d=f.length;d--;)L(f,d,c);else e(f,function(a){L(f,a,c)});return c.call(a,b,f)};j.parse=function(a,b){var c,d;return E=0,F=""+a,c=K(J()),"$"!=J()&&I(),E=F=null,b&&g.call(b)==m?M((d={},d[""]=c,d),"",b):c}}}h&&define(function(){return j})}(this)},{}],6:[function(a,b,c){var d;d=a("./widgetic"),window.Widgetic||(window.Widgetic=new d),b.exports=window.Widgetic,window.Blogvio=window.Widgetic},{"./widgetic":23}],7:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},q=[].slice;h=a("config"),i=a("utils/guid"),m=a("./../../../../bower/queue-async/queue.js"),e=a("../../api"),f=a("../../auth"),g={},n=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave","mouseover","mouseout","wheel","keydown","keyup","keypress"],d=function(a,b,c){var d,j,k,l,n,o,p,q=this;if(null==c&&(c={}),"string"==typeof b&&(j=b),l=j?c:b,null==j&&(j=l.composition),this._queue=m(1),this._queue.defer(function(a){return q._startQueue=a}),j?p=h.composition.replace("{id}",j):(p=h.widget.replace("{id}",l.widget_id),null!=l.id&&(p+="#comp="+l.id),l.skin&&this.setSkin(l.skin),l.content&&this.setContent(l.content)),n=[],d=f.getClientId(),k="connected"===e.getStatus().status,null!=l.widget_id&&!d&&!k)throw new Error("Widgetic should be initialized before using the UI.Composition!");return(o=l.token||e.accessToken())&&n.push("access_token="+o),d&&n.push("client_id="+d),l.wait_editor_init&&n.push("wait"),l.branding&&n.push("branding"),l.brand_pos&&n.push("bp="+l.brand_pos),l.edit_mode&&n.push("edit_mode"),l.resize&&n.push("resize="+l.resize),l.autoscale&&n.push("autoscale="+l.autoscale),n.length&&(p=p.replace(/(\?)|((.)(\#)|($))/,"?"+(n.length?n.join("&"):void 0)+"&$2")),this.id=i(),g[this.id]=this,this._iframe=document.createElement("iframe"),this._iframe.setAttribute("class","widgetic-composition"),this._iframe.setAttribute("name",this.id),this._iframe.setAttribute("allowfullscreen",!0),a.appendChild(this._iframe),this._iframe.setAttribute("src",p),0===this._iframe.parentElement.parentElement.className.indexOf("wdgtc-wrap")&&(this._responsiveWrapper=this._iframe.parentElement.parentElement),this._autoscale="off"!==l.autoscale,this._readyDeferred=Widgetic.Aye.defer(),this.ready=this._readyDeferred.promise,this},d.prototype.updateSize=function(a,b){return this._autoscale?(b&&(b=parseInt(b,10),this._responsiveWrapper&&(this._responsiveWrapper.style.height=b+"px"),this._iframe.style.height=b+"px"),a?this._iframe.setAttribute("width",a):void 0):void 0},d.prototype.close=function(){return g[this.id]=null,this._iframe.parentNode.removeChild(this._iframe),this.off(),this},d.prototype.queue=function(a){return this._queue.defer(function(b){return a(),b()})},d.prototype._apiReady=function(){return this._startQueue()},d.prototype._ready=function(){return this._readyDeferred.resolve()},d.prototype._sendMessage=function(a){var b=this;return this._queue.defer(function(c){return b._iframe.contentWindow.postMessage(JSON.stringify(a),"*"),c()}),this},d.prototype.on=function(a,b){var c,d,e,f,g;for(p.call(n,a)>=0&&this._sendMessage({t:"re",d:a}),d=a.split(" "),c=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),f=0,g=d.length;g>f;f++)e=d[f],c[e]||(c[e]=[]),c[e].push(b);return this},d.prototype.off=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(0===arguments.length)return this._callbacks={},this;if(!a)return this;for(d=a.split(" "),h=0,j=d.length;j>h;h++)if(g=d[h],f=null!=(l=this._callbacks)?l[g]:void 0)if(b){for(e=i=0,k=f.length;k>i;e=++i)if(c=f[e],c===b){f=f.slice(),f.splice(e,1),this._callbacks[g]=f;break}}else delete this._callbacks[g];return this},d.prototype._trigger=function(){var a,b,c,e,f,g,h;if(a=1<=arguments.length?q.call(arguments,0):[],c=a.shift(),c===d.RELAY&&(c=a[0].type),e=this.hasOwnProperty("_callbacks")&&(null!=(h=this._callbacks)?h[c]:void 0)){for(f=0,g=e.length;g>f&&(b=e[f],b.apply(this,a)!==!1);f++);return!0}},l={clearContent:"cx",setContent:"sc",addContent:"ac",changeContent:"cc",removeContent:"rc",setSkin:"ss",changeSkin:"cs",addSheet:"asht",addCss:"acss"},o=function(a,b){return d.prototype[a]=function(a){return this._sendMessage({t:b,d:a})}};for(k in l)j=l[k],o(k,j);d.apiReady=function(a){var b;return null!=(b=g[a.d])?b._apiReady():void 0},d.connect=function(a){var b;return null!=(b=g[a.d])?b._ready():void 0},d.event=function(a){return g[a.id]._trigger(a.e,a.d)},d.updateSize=function(a){return g[a.id].updateSize(a.d.width,a.d.height)},d.RELAY="r",d.EMBED_MODE=1,d.EDIT_MODE=2,b.exports=d},{"../../api":13,"../../auth":16,"./../../../../bower/queue-async/queue.js":3,config:18,"utils/guid":25}],8:[function(a,b,c){var d,e,f,g,h,i,j,k,l=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},m=[].slice;f=a("config"),j=a("./../../../../bower/queue-async/queue.js"),i=a("./../../../../bower/pubsub.js/src/pubsub.js"),h=a("utils/guid"),e=a("../../api"),g={},k=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave","mouseover","mouseout","wheel","keydown","keyup","keypress"],d=function(a,b,c){var d,e=this;return this.composition=b,this._queue=j(1),this._queue.defer(function(a){return e._startQueue=a}),i.subscribe("api/token/update",this._updateToken.bind(this)),this._updateToken(),c&&this.setEditorOptions(c),this.composition.ready.then(this._compReady.bind(this)),g[this.composition.id]=this,d=f.editor+"#"+this.composition.id,(null!=c?c.asPopup:void 0)?(this.frame=a)?this.frame.location.href=d:this.frame=window.open(d,h(),"height="+(c.h||565)+",width="+(c.w||490)):(this._iframe=document.createElement("iframe"),this._iframe.setAttribute("class","widgetic-editor"),this._iframe.setAttribute("name",h()),a.appendChild(this._iframe),this._iframe.setAttribute("src",d),this.frame=this._iframe.contentWindow),this},d.prototype.close=function(){return g[this.composition.id]=null,this._iframe?this._iframe.parentNode.removeChild(this._iframe):this.frame.close(),this},d.prototype.goTo=function(a){return this._sendMessage({t:"step",d:a}),this},d.prototype.setEditorOptions=function(a){return this.options=null!=a?a:this.options,this._sendMessage({t:"opts",d:this.options}),this},d.prototype.addContent=function(a){return this._sendMessage({t:"cont",d:a}),this},d.prototype.save=function(){return this.goTo("done"),this},d.prototype.on=function(a,b){var c,d,e,f,g;for(l.call(k,a)>=0&&this._sendMessage({t:"ree",d:a}),d=a.split(" "),c=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),f=0,g=d.length;g>f;f++)e=d[f],c[e]||(c[e]=[]),c[e].push(b);return this},d.prototype.off=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(0===arguments.length)return this._callbacks={},this;if(!a)return this;for(d=a.split(" "),h=0,j=d.length;j>h;h++)if(g=d[h],f=null!=(l=this._callbacks)?l[g]:void 0)if(b){for(e=i=0,k=f.length;k>i;e=++i)if(c=f[e],c===b){f=f.slice(),f.splice(e,1),this._callbacks[g]=f;break}}else delete this._callbacks[g];return this},d.prototype._trigger=function(){var a,b,c,e,f,g,h;if(a=1<=arguments.length?m.call(arguments,0):[],c=a.shift(),c===d.RELAY&&(c=a[0].type),e=this.hasOwnProperty("_callbacks")&&(null!=(h=this._callbacks)?h[c]:void 0)){for(f=0,g=e.length;g>f&&(b=e[f],b.apply(this,a)!==!1);f++);return!0}},d.prototype._sendMessage=function(a){var b=this;return this._queue.defer(function(c){return b.frame.postMessage(JSON.stringify(a),"*"),c()})},d.prototype._ready=function(){return this.ready=!0,this._startQueue()},d.prototype._compReady=function(){return this.compReady=!0,this._sendMessage({t:"ready"})},d.prototype._updateToken=function(){return this._sendMessage({t:"token",d:e.accessToken()})},d.prototype._onConnect=function(){var a=this;return this.ready&&this.compReady&&this._queue.defer(function(b){return a.setEditorOptions(),a._compReady(),b()}),this._ready()},d.connect=function(a){return g[a.id]._onConnect()},d.event=function(a){return g[a.id]._trigger(a.e,a.d)},d.RELAY="er",b.exports=d},{"../../api":13,"./../../../../bower/pubsub.js/src/pubsub.js":2,"./../../../../bower/queue-async/queue.js":3,config:18,"utils/guid":25}],9:[function(a,b,c){var d,e,f,g,h,i,j;d=a("./composition"),e=a("./editor"),i=a("./plugin"),j=a("./popup"),h=a("./parse"),f=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(d,arguments,function(){})},g=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(e,arguments,function(){})},b.exports={Composition:d,Editor:e,composition:f,editor:g,parse:h,popup:j,plugin:i}},{"./composition":7,"./editor":8,"./parse":10,"./plugin":11,"./popup":12}],10:[function(a,b,c){var d,e,f,g,h,i,j,k,l;l=a("../utils/ready"),d="allow-scale-down",i=function(a){var b,c,d;return b=a.children[0],d=a.parentNode,a.removeChild(b),c=document.createDocumentFragment(),c.insertBefore(b,null),d.insertBefore(c,a),d.removeChild(a),b},f=function(a){return a.children[0]},j=function(a,b,c,d){var e;return e=b?"display:inline-block;vertical-align:middle;":"",d?'<div style="width:100%;'+e+(c.wrapStyle||"")+'">'+('<div style="position:relative; padding: 0;'+(c.holdStyle||"")+'">')+"$$$</div></div>":'<div class="wdgtc-wrap" data-wdgtc-id="'+a+'" style="width:100%;'+e+(c.wrapStyle||"")+'">			<div class="wdgtc-holder" style="position:relative; padding: 0;'+(c.holdStyle||"")+'">			</div>		</div>'},k={fixed:function(a,b){var c;return c=100*b/a,{wrapStyle:"max-width: "+a+"px; min-width: "+a+"px;",holdStyle:"padding-top: "+c+"%;"}},"allow-scale-down":function(a,b){var c;return c=100*b/a,{wrapStyle:"max-width: "+a+"px;",holdStyle:"padding-top: "+c+"%;"}},"fixed-height":function(a,b){return{holdStyle:"height: "+b+"px; padding-top: 0;"}},"fill-width":function(a,b){var c;return c=100*b/a,{holdStyle:"padding-top: "+c+"%;"}},fill:function(a,b){return{wrapStyle:"height: 100%",holdStyle:"height: 100%;min-height:"+b+"px"}}},h=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;for(g=/\[widgetic\-([-\w]+) *((?: [-\w]+(?:=.*?)?)+)\]/gi,c=/\s+/g,h=function(a,b,d){var e;return e=d.trim().replace(c," ").split(" ").map(function(a){return"data-"+a}).join(" "),'<a href="https://widgetic.com/widget/'+b+'/" class="widgetic-composition" '+e+"></a>"},l=document.querySelectorAll("body, body *"),n=[],j=0,k=l.length;k>j;j++)f=l[j],"HEAD"!==(m=f.nodeName)&&"META"!==m&&"LINK"!==m&&"SCRIPT"!==m&&"TITLE"!==m&&(a=f.childNodes,n.push(function(){var c,j,k;for(k=[],c=0,j=a.length;j>c;c++)b=a[c],3===b.nodeType&&(i=b.nodeValue,e=i.replace(g,h),i!==e?(d=document.createElement("div"),d.innerHTML=e,k.push(f.replaceChild(d,b))):k.push(void 0));return k}()));return n},g=function(){return l(function(){var a,b,c,d;for(h(),a=document.querySelectorAll(".widgetic-composition"),c=0,d=a.length;d>c;c++)b=a[c],e(b)})},g.wrapperHtml=function(a,b){var c;return null==b&&(b=!1),c=k[a.resize](a.width,a.height),j(a.composition,a.inline,c,b)},g.iframeStyle="position:absolute;top:0;left:0;width:100%;height:100%;",e=function(a){var b,c,e;return e={composition:a.getAttribute("data-id"),width:a.getAttribute("data-width")||300,height:a.getAttribute("data-height")||200,resize:a.getAttribute("data-resize")||d,brand_pos:a.getAttribute("data-brand")||"bottom-right",branding:a.hasAttribute("data-branding"),inline:a.hasAttribute("data-inline"),autoscale:a.getAttribute("data-autoscale")||"on"},e.composition?(k[e.resize]||(e.resize=d),a.insertAdjacentHTML("afterbegin",g.wrapperHtml(e)),a=i(a),c=f(a),b=new Widgetic.UI.composition(c,e.composition,e),b._iframe.setAttribute("style",g.iframeStyle),b._iframe.style.visibility="hidden",b._iframe.onload=function(){return b._iframe.style.visibility="visible"}):void 0},b.exports=g},{"../utils/ready":27}],11:[function(a,b,c){var d,e,f,g,h,i,j=[].slice;f=a("config"),i=a("./../../../../bower/queue-async/queue.js"),h=a("./../../../../bower/pubsub.js/src/pubsub.js"),g=a("utils/guid"),e=a("../../api"),d=function(){function a(a){var b,c,d=this;this.id=g(),this.name=a.name||this.id,this._queue=i(1),this._queue.defer(function(a){return d._startQueue=a}),h.subscribe("api/token/update",this._updateToken.bind(this)),this._updateToken(),a&&this.setOptions(a),b=f.plugin,(this.frame=(null!=(c=a.holder)?c.document:void 0)||a.holder)?(this._iframe=document.createElement("iframe"),this._iframe.setAttribute("class","wdtc-plugin"),this._iframe.setAttribute("name",this.name),this.frame.appendChild(this._iframe),this._iframe.setAttribute("src",b),this.frame=this._iframe.contentWindow):this.frame=window.open(b,this.name,"height="+(a.h||760)+",width="+(a.w||1270))}return a.instances={},a.connect=function(b){var c;return c=a.instances[b.id],c._updateToken(),c._ready(),c._sendMessage({t:"ready"})},a.event=function(b){return a.instances[b.id]._trigger(b.e,b.d)},a.create=function(a){var b;return null==a&&(a={}),b=new this(a),this.instances[b.id]=b},a.prototype.close=function(){return this.constructor.instances[this.id]=null,delete this.constructor.instances[this.id],this._iframe?this._iframe.parentNode.removeChild(this._iframe):this.frame.close(),this},a.prototype.setOptions=function(a){return this.options=null!=a?a:this.options,this._sendMessage({t:"opts",d:this.options}),this},a.prototype.addEditorContent=function(a){return this._sendMessage({t:"econt",d:a}),this},a.prototype.on=function(a,b){var c,d,e,f,g;for(d=a.split(" "),c=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),f=0,g=d.length;g>f;f++)e=d[f],c[e]||(c[e]=[]),c[e].push(b);return this},a.prototype.off=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(0===arguments.length)return this._callbacks={},this;if(!a)return this;for(d=a.split(" "),h=0,j=d.length;j>h;h++)if(g=d[h],f=null!=(l=this._callbacks)?l[g]:void 0)if(b){for(e=i=0,k=f.length;k>i;e=++i)if(c=f[e],c===b){f=f.slice(),f.splice(e,1),this._callbacks[g]=f;break}}else delete this._callbacks[g];return this},a.prototype._trigger=function(){var a,b,c,d,e,f,g;if(a=1<=arguments.length?j.call(arguments,0):[],c=a.shift(),d=this.hasOwnProperty("_callbacks")&&(null!=(g=this._callbacks)?g[c]:void 0)){for(e=0,f=d.length;f>e&&(b=d[e],b.apply(this,a)!==!1);e++);return!0}},a.prototype._sendMessage=function(a){var b=this;return this._queue.defer(function(c){return b.frame.postMessage(JSON.stringify(a),"*"),c()})},a.prototype._ready=function(){return this._startQueue()},a.prototype._updateToken=function(){return this._sendMessage({t:"token",d:e.accessToken()})},a}.call(this),b.exports=d},{"../../api":13,"./../../../../bower/pubsub.js/src/pubsub.js":2,"./../../../../bower/queue-async/queue.js":3,config:18,"utils/guid":25}],12:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=function(a,b){return function(){return a.apply(b,arguments)}};f=a("./../../../../bower/aye/ayepromise.js"),p=a("utils/guid"),q=a("json3"),k=a("utils/event"),h=a("config"),l=function(a){var b,c,d,e;for(null==a&&(a={}),d=0,e=arguments.length;e>d;d++)if(b=arguments[d])for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},i=function(a,b){var c;return null==b&&(b=10),c=null,function(){return clearTimeout(c),c=setTimeout(a,b)}},n=function(a){var b;return b=a.getBoundingClientRect(),{top:b.top+document.body.scrollTop,left:b.left+document.body.scrollLeft}},r=function(a,b,c){var d;return d=this.document.createElement("link"),d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("charset","utf-8"),d.setAttribute("href",a),c&&(k.on(d,"load",c),k.on(d,"error",c)),b.appendChild(d)},s=function(a,b,c,d){var e,f,g,h,i,j,k,l;for(null==b&&(b=[]),null==c&&(c=[]),e=[].concat(b,c),i=e.length,f=0,j=!0,g=function(a){return("load"===a.type||c.indexOf(a.target.href)>-1)&&++f,f!==i&&j?void 0:d()},k=0,l=e.length;l>k;k++)h=e[k],r(h,a,g);return setTimeout(d,5e3),setTimeout(function(){return j=!1},5e3)},j={},t=function(a){var b,c,d,e;return c=p(),e=(j[c]=b=f.defer()).promise,d={id:c,t:"p",d:a},{promise:e,message:d}},e=function(a,b){return j[a.id].resolve(b)},v=function(a,b){return null==b&&(b=window.parent),"string"==typeof b&&(b=window.frames[b]),b.postMessage(JSON.stringify(a),"*")},u=function(a,b,c){return a.d.original=a.d.event,a.d.event="done",a.d.response=c,v(a,b.source)},w=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},m=function(a,b){var c;return a?(c=window.getComputedStyle(a).getPropertyValue(b),c?c:void 0):void 0},o=function(a){try{return a.innerHTML}catch(b){return a.styleSheet.cssText}},g=function(a){return a?{top:a.top,right:a.right,bottom:a.bottom,left:a.left,width:a.width,height:a.height}:{}},x=function(a){var b;return{popup:g(a.getBoundingClientRect()),widget:g(null!=(b=a._parentFrame)?b.getBoundingClientRect():void 0)}},d=function(){function a(a){this._prepare=y(this._prepare,this),this._saveInfo=y(this._saveInfo,this),this.position=y(this.position,this),this._hide=y(this._hide,this),this.resize=y(this.resize,this);var b,c,d;this.options=a,d=this.options;for(b in d)c=d[b],this[b]=c;null==this.anchor&&(this.anchor=document.body),this.anchor.jquery&&(this.anchor=this.anchor[0]),this.dimensions={width:0,height:0},this.info={},this.visible=!1,this._callbacks={}}return a.styles={popup:"			body {				display:inline-block;				margin:0;				width:auto !important;				height:auto !important;				overflow:hidden;				background:transparent !important			}			#loader {				width: 250px;				height: 250px;				border: 1px solid #d5d5d5;				background: white;			}			.sk-three-bounce {				margin: 115px auto;				width: 40px;				text-align: center; }				.sk-three-bounce .sk-child {					width: 10px;					height: 10px;					background-color: #262424;					border-radius: 100%;					display: inline-block;					-webkit-animation: sk-three-bounce 1.4s ease-in-out 0s infinite both;									animation: sk-three-bounce 1.4s ease-in-out 0s infinite both; }				.sk-three-bounce .sk-bounce1 {					-webkit-animation-delay: -0.32s;									animation-delay: -0.32s; }				.sk-three-bounce .sk-bounce2 {					-webkit-animation-delay: -0.16s;									animation-delay: -0.16s; }			@-webkit-keyframes sk-three-bounce {				0%, 80%, 100% {					-webkit-transform: scale(0);									transform: scale(0); }				40% {					-webkit-transform: scale(1);									transform: scale(1); } }			@keyframes sk-three-bounce {				0%, 80%, 100% {					-webkit-transform: scale(0);									transform: scale(0); }				40% {					-webkit-transform: scale(1);									transform: scale(1); } }		",overlay:"			html, body {				width:100%;				height:100%;			}			body {				display:block;				margin:0;				overflow:hidden;			}		"},a.popups={},a.callbacks={},a.iframes={},a["new"]=function(b){var c;return null==b&&(b={}),c=b.name||p(),b.name=c,this.popups[c]=new a(b),this.popups[c].init()},a.receiver=function(b,c){var d;return d=b.d.event,d="on"+w(d),"function"==typeof a[d]?a[d](b,c):void 0},a.onCreate=function(a,b){var c,d,e=this;return d=a.d.name,c=document.createElement("iframe"),c.setAttribute("class","wdgtc-popup"),c.setAttribute("name",d),c.isOverlay="overlay"===a.d.type,c.setAttribute("style","border: 0; width: 0; height: 0; position: absolute; top: 0; left: -10000px; z-index: 2147483646;"),c.isOverlay&&(c.style.zIndex=2147483647),c.isVisible=!1,c._parent=b.source,c._parentFrame=document.getElementsByName(a.d.source)[0],document.querySelectorAll("body")[0].appendChild(c),c.setAttribute("src",h.popup+"&name="+encodeURIComponent(d)+"&event=ready"),this.iframes[d]=c,c.doPosition=function(){var a;return e.doPosition(c,null),a={t:"p",d:{event:"reposition",name:d,response:{info:x(c)}}},v(a,c._parent)},c.doPosition=i(c.doPosition),k.on(window,"resize",c.doPosition),k.on(window,"scroll",c.doPosition),this.callbacks[d]=function(){return delete e.callbacks[d],u(a,b)}},a.onReady=function(a){var b,c;return"function"==typeof(b=this.callbacks)[c=a.d.name]?b[c]():void 0},a.onDone=function(a,b){var c;return c=a.d.original,c="on"+w(c)+"Done",this[c]?this[c](a,b):e(a,a.d.response)},a.onCreateDone=function(a,b){var c,d;if(d=b.source,!(c=d.frames[a.d.name]))for(;d!==b.source.top;){d=d.parent;try{if(c=d.frames[a.d.name])break}catch(f){}}return e(a,c)},a.onReposition=function(a,b){return this.popups[a.d.name].info=a.d.response.info,this.popups[a.d.name].trigger("reposition")},a.onManage=function(a,b){var c,d,e,f;return e=a.d.name,c=this.iframes[e],d="do"+w(a.d["do"]),f=("function"==typeof this[d]?this[d](c,a.d):void 0)||{},f.info=x(c),u(a,b,f)},a.doResize=function(a,b){return a.isOverlay?b.dimensions:(a.style.width=b.dimensions.width+"px",a.style.height=b.dimensions.height+"px",b.dimensions.shadow&&(a.style.boxShadow=b.dimensions.shadow),b.dimensions.borderRadius&&(a.style.borderRadius=b.dimensions.borderRadius),b.dimensions)},a.doHide=function(a,b){a.isVisible=!1,a.style.display="none"},a.doShow=function(a,b){a.isVisible=!0,a.style.display="block",a.style.position=a.isOverlay?"fixed":"absolute"},a.doPosition=function(a,b){var c,d,e,f,g,h,i;if(a.isVisible||(a.style.display="none"),a.isOverlay)return a.style.position="fixed",a.style.width="100%",a.style.height="100%",
a.style.top=0,a.style.left=0,a.style.bottom=0,void(a.style.right=0);if(b)a.positionOptions=b;else{if(!a.positionOptions)return;b=a.positionOptions}f=b.offset,g=b.dimensions,c=l({},b.anchor),d=document.querySelector('iframe[name="'+c.parent+'"]'),d&&(i=n(d),h=i.top,e=i.left,c.top+=h,c.left+=e),e=window.innerWidth+document.body.scrollLeft-(c.left+g.width+f.rightMargin+f.leftOffset),e=Math.max(0,c.left+f.leftOffset+Math.min(0,e)),h=window.innerHeight+document.body.scrollTop-(c.top+c.height+g.height+f.bottomMargin),h=h>=0?c.top+c.height+f.topOffset:c.top-g.height-f.bottomMargin,0>h&&(h=c.top+c.height+f.topOffset),a.style.top=h+"px",a.style.left=e+"px"},a.doRelease=function(a,b){var c;a.parentNode.removeChild(a),k.off(window,"resize",a.doPosition),k.off(window,"scroll",a.doPosition),c=b.name,delete this.iframes[c]},a.hideAll=function(){var b,c,d;return d=function(){var d,e;d=a.iframes,e=[];for(b in d)c=d[b],e.push(c);return e}(),d.filter(function(a){return a.isVisible}).map(function(b){return a.doHide(b),v({t:"p",d:{event:"hide",name:b.name}},b._parent)})},a.onHide=function(a,b){var c;return c=this.popups[a.d.name],c._hide()},a.prototype.type="popup",a.prototype.topOffset=0,a.prototype.leftOffset=0,a.prototype.rightMargin=15,a.prototype.bottomMargin=15,a.prototype.copyStyles=!0,a.prototype.on=function(a,b){return this._callbacks[a]=this._callbacks[a]||[],this._callbacks[a].push(b)},a.prototype.off=function(a){return a?this._callbacks[a]=[]:this._callbacks={}},a.prototype.trigger=function(a,b){var c,d,e,f,g;if(this._callbacks[a]){for(f=this._callbacks[a],g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c(b));return g}},a.prototype.init=function(){var a;return a=this._sendEvent("create",{type:this.type,source:window.name}),a.then(this._prepare)},a.prototype.append=function(a){return a.jquery&&(a=a[0]),this.content.innerHTML="",this.content.appendChild(a),this.resize()},a.prototype.style=function(a,b){var c;null==b&&(b=!1),this.styleElement||(this.styleElement=document.createElement("style"),this.head.appendChild(this.styleElement)),null==this.preservedStyles&&(this.preservedStyles="");try{this.styleElement.innerHTML=this.preservedStyles+a}catch(d){this.styleElement.styleSheet.cssText=this.preservedStyles+a}return b&&(this.preservedStyles+=a),c=f.defer(),c.resolve(this.preservedStyles+a),c.promise},a.prototype.resize=function(){return this.dimensions={width:this.document.body.offsetWidth,height:this.document.body.offsetHeight},this._sendEvent("manage",{"do":"resize",dimensions:this.dimensions}).then(this._saveInfo)},a.prototype.hide=function(){return this._sendEvent("manage",{"do":"hide"}).then(this._saveInfo).then(this._hide)},a.prototype._hide=function(){return this.visible=!1},a.prototype.show=function(){var a=this;return this.position().then(function(){return a._sendEvent("manage",{"do":"show"}).then(a._saveInfo).then(function(){return a.visible=!0})})},a.prototype.position=function(){var a,b;return b={topOffset:this.topOffset,leftOffset:this.leftOffset,bottomMargin:this.bottomMargin,rightMargin:this.rightMargin},a=n(this.anchor),a.parent=window.name,a.width=parseInt(this.anchor.offsetWidth,10),a.height=parseInt(this.anchor.offsetHeight,10),this._sendEvent("manage",{"do":"position",anchor:a,dimensions:this.dimensions,offset:b}).then(this._saveInfo)},a.prototype.release=function(){var a,b,c=this;return a=f.defer(),b=a.promise,this.document.location.reload(),setTimeout(a.resolve,1e3),b.then(function(){return c._sendEvent("manage",{"do":"release"})})},a.prototype._saveInfo=function(a){return this.info=a.info,a},a.prototype._sendEvent=function(a,b){var c,d,e,f;return c={name:this.name,event:a},c=l(c,b),f=t(c),e=f.promise,d=f.message,v(d,this.targetWindow),e},a.prototype._prepare=function(b){var c,d,e=this;return this.window=b,this.document=this.window.document,this.head=this.document.head,this.loader=document.createElement("div"),this.loader.id="loader",this.loader.style.display="none",this.loader.innerHTML='<div class="sk-three-bounce">				<div class="sk-child sk-bounce1"></div>				<div class="sk-child sk-bounce2"></div>				<div class="sk-child sk-bounce3"></div>			</div>',this.document.body.appendChild(this.loader),this.content=document.createElement("div"),this.document.body.appendChild(this.content),d='<style type="text/css">'+a.styles[this.type]+"</style>",this.head.insertAdjacentHTML("beforeend",d),d=document.querySelectorAll("[data-widget-style=true]"),d=Array.prototype.map.call(d,o),d=d.reduce(function(a,b){return a+=b},""),this.style(d,!0),c=document.querySelectorAll('link[rel="stylesheet"]'),c=Array.prototype.map.call(c,function(a){return a.href}),(this.css||c.length)&&(this.loader.style.display="block",this.content.style.display="none",s(this.head,this.css,c,function(){return e.loader.style.display="none",e.content.style.display="block",e.resize().then(function(){return e.position().then(function(){return e})})})),this},a}.call(this),k.on(window.document,"click",d.hideAll),b.exports=d},{"./../../../../bower/aye/ayepromise.js":1,config:18,json3:5,"utils/event":24,"utils/guid":25}],13:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;f=a("../config"),n=a("./request"),m=a("../utils/queue"),h=a("../utils/guid"),e=a("./../../../bower/aye/ayepromise.js"),i=a("json3"),l=a("./../../../bower/pubsub.js/src/pubsub.js"),g={},j={},q=null,p=null,k=function(a,b,c,d){var e,g;return a=f.api+a,e=(null!=(g=j.tokens)?g.access_token:void 0)||!1,(b||(b="GET"))instanceof Object&&(c=b,b="GET"),"GET"!==b?a+=e?"?access_token="+e:"":(c||(c={}),e&&(c.access_token=e)),i.stringify({t:"a",id:d,a:{u:a,m:b,d:c}})},d=function(a,b,c){var d,f,i,l,m;return i=h(),m=(g[i]=f=e.defer()).promise,l=k.apply(this,f.margs=[a,b,c,i]),d=function(){return g[i]=null},m.then(d,d),j.proxy(l),m},d.response=function(a){var b,c,d,e,f,h;if(d=g[a.id],b=a.a,c=b.d,""!==c)try{c=i.parse(c)}catch(l){return void d.reject(new Error("JSON Parse error!"))}return"t"===b.t?d.resolve(c):j.tokens&&c.error&&("invalid_grant"===(h=c.error)||"access_denied"===h)?(f=function(){return q=null,j.proxy(k.apply(this,d.margs))},o().then(f,function(){return q=null,d.reject(new Error("Unable to login again!"))})):(e=new Error(c.error_description||c.message||"Unknown Error"),e.errors=c.errors,e.code=c.code,d.reject(e))},o=function(){var b,c,d;return null!=(b=a("../auth/index")).getClientId()?b(!1):(d=(q=e.defer()).promise,c=i.stringify({t:"r",d:[!1]}),window.parent.postMessage(c,f.lo),p=setTimeout(q.reject,3e3),d)},d.setProxy=function(a){return j.proxy=a},d.setTokens=function(a){return j.tokens=a,l.publish("api/token/update")},d.getStatus=function(){var a;return(null!=(a=j.tokens)?a.access_token:void 0)?{status:"connected",accessToken:j.tokens.access_token,refreshToken:j.tokens.refresh_token,expiresIn:j.tokens.expires_in,scope:j.tokens.scope}:{status:"disconnected"}},d.accessToken=function(a){var b;return a&&(clearTimeout(p),null!=q&&q.resolve(a),d.setTokens({access_token:a,refresh_token:void 0,expires_in:void 0,scope:void 0})),null!=(b=j.tokens)?b.access_token:void 0},d.disconnect=function(){return l.publish("api/token/update"),j.tokens=null},d.queue=m,d.request=n,b.exports=d},{"../auth/index":16,"../config":18,"../utils/guid":25,"../utils/queue":26,"./../../../bower/aye/ayepromise.js":1,"./../../../bower/pubsub.js/src/pubsub.js":2,"./request":14,json3:5}],14:[function(a,b,c){var d,e,f,g;g=a("./../../../bower/uxhr/uxhr.js"),e=a("json3"),d=a("../config"),f=function(a){var b,c,f,h,i,j,k,l;if(a.id&&(b=a.a))return l=b.u,j=b.m,f=b.d,i={id:a.id,t:"e",a:{}},h={"Content-type":"application/json"},("PUT"===(j=j.toUpperCase())||"DELETE"===j)&&(h["X-HTTP-Method-Override"]=j,j="POST"),c=function(a,b){return i.a.t=200===b||201===b||202===b||204===b?"t":"f",i.a.d=a,i=e.stringify(i),d.crossdomain?window.parent.postMessage(i,"*"):window.widgeticReceiver({origin:window.location.origin,data:i})},k={method:j,headers:h,complete:c},g(l,f,k)},b.exports=f},{"../config":18,"./../../../bower/uxhr/uxhr.js":4,json3:5}],15:[function(a,b,c){var d,e,f,g;d=a("./../../../bower/aye/ayepromise.js"),g=window,f={},e=function(a,b){var c,d,g,h,i;return h=b.promise,e=document.createElement("iframe"),g=f.root.el,g.appendChild(e),d=function(){return b.reject("Timeout error")},c=function(){return g.removeChild(e),clearTimeout(i)},i=setTimeout(d,1e4),h.then(c,c),e.setAttribute("src",a),h},e.setRoot=function(a){return f.root=a},b.exports=e},{"./../../../bower/aye/ayepromise.js":1}],16:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;h=a("../config"),d=a("../api"),m=a("./popup"),j=a("./iframe"),g=a("./../../../bower/aye/ayepromise.js"),e={},l={},k=[],n=function(a,b){return null==a&&(a=[]),null==b&&(b="oauth"),""+h.auth+"?client_id="+e.id+"&redirect_uri="+e.uri+"&response_type=token&scope="+a.join(" ")+"#"+b},o=function(a,b){var c,d;return null==a&&(a=!0),c=g.defer(),d=a?m:j,b&&(k=b),b=k,l.deffered=c,{oa:d,scope:b,deffered:c}},i=function(a,b,c){return e.id&&e.uri?a(b,c):(c.reject("Widgetic must be initialized with client id and redirect uri!"),c.promise)},f=function(){var a,b,c,d;return d=o.apply(null,arguments),b=d.oa,c=d.scope,a=d.deffered,i(b,n(c),a)},f.register=function(a){var b,c,d;return d=o(!0,a),c=d.oa,a=d.scope,b=d.deffered,i(c,n(a,"signup"),b)},f.setAuthOptions=function(a,b,c){return e.id=a,e.uri=b},f.getClientId=function(){return e.id},f.retry=function(a){return f.apply(this,a.d)},f.connect=function(a){var b;return b=a.d,b&&b.access_token?(d.setTokens(b),l.deffered.resolve(d.getStatus()),setTimeout(f.bind(this,!1),1e3*b.expires_in-1500)):l.deffered.reject(d.getStatus())},b.exports=f},{"../api":13,"../config":18,"./../../../bower/aye/ayepromise.js":1,"./iframe":15,"./popup":17}],17:[function(a,b,c){var d,e,f,g,h,i;d=a("./../../../bower/aye/ayepromise.js"),e=a("../utils/guid"),i=window,f={},g=function(a,b){var c,d;return c=(screen.width-a)/2,d=(screen.height-b)/2,"location=no,menubar=no,toolbar=no,scrollbars=no,status=no,resizable=no,width="+a+",height="+b+",left="+c+",top="+d},h=function(a,b){var c,d,h,j,k;return h=b.promise,null!=(k=f.win)&&k.close(),f.win=j=i.open(a,"widgetic_popup_"+e(),g(500,496)),c=function(){return!j||j.closed?(clearInterval(d),b.reject("window closed")):void 0},d=setInterval(c,50),h.then(function(){return j.close()}),h},b.exports=h},{"../utils/guid":25,"./../../../bower/aye/ayepromise.js":1}],18:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;l=window.location,l.origin||(l.origin=l.protocol+"//"+l.hostname+(l.port?":"+l.port:"")),i=a("./detect/parse"),e=(null!=(m=window.widgeticOptions)?m.domain:void 0)||"widgetic.com",f=(null!=(n=window.widgeticOptions)?n.domainProtocol:void 0)||"https",h="?lo="+encodeURIComponent(l.origin),k=(null!=(o=window.widgeticOptions)?o.secure:void 0)===!1?"http":"https",j=i(e),g=j.host+(j.port?":"+j.port:""),d={proxy:""+k+"://"+g+"/sdk/proxy.html"+h+"#proxy",popup:""+k+"://"+g+"/sdk/proxy.html"+h+"#popup",auth:""+k+"://"+e+"/oauth/v2/auth",composition:""+k+"://"+e+"/api/v2/compositions/{id}/embed.html"+h,widget:""+k+"://"+e+"/api/v2/widgets/{id}/embed.html"+h,editor:""+k+"://"+e+"/api/v2/editor.html"+h,plugin:""+k+"://"+g+"/plugin"+h,api:"/api/v2/",domain:""+f+"://"+g,lo:decodeURIComponent(i(l).queryKey.lo||l.origin),crossdomain:(null!=(p=window.widgeticOptions)?p.crossdomain:void 0)||!0},b.exports=d},{"./detect/parse":21}],19:[function(a,b,c){b.exports={COMPOSITION_SAVED:"save",SKIN_SAVED:"skin-save"}},{}],20:[function(a,b,c){var d,e,f,g,h;d=a("../config"),g=a("./parse"),f=a("json3"),h=window,e=function(a){var b,c,e,i,j,k,l,m,n,o,p;if((!h.parent||h.parent!==h||h.opener)&&(l=g(a),c=l.hash,e=l.hashKey,m=l.query,n=l.queryKey,k="proxy"===c,j=e.hasOwnProperty("popup"),i=e.hasOwnProperty("oauth")||e.access_token,i||k||j))return i&&(p="o"),k&&(p="i"),j&&(p="p"),b=c?e:n,o=i?h.location.origin:d.lo,(h.opener||h.parent).postMessage(f.stringify({d:b,t:p}),o)},e.parse=g,b.exports=e},{"../config":18,"./parse":21,json3:5}],21:[function(a,b,c){var d;d=function(a){var b,c,e,f;for(e=d.options,c=e.parser[e.strictMode?"strict":"loose"].exec(a),f={},b=14;b--;)f[e.key[b]]=c[b]||"";return f[e.q.name]={},f[e.key[12]].replace(e.q.parser,function(a,b,c){return b?f[e.q.name][b]=c:void 0}),f[e.h.name]={},f[e.key[13]].replace(e.h.parser,function(a,b,c){return b?f[e.h.name][b]=c:void 0}),f},d.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","hash"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},h:{name:"hashKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},b.exports=d},{}],22:[function(a,b,c){var d,e,f,g,h,i,j,k,l;h="#widgetic-root{position:absolute;top:-1000px;left:-1000px;width:0px;height:0px;visibility:hidden;z-index:-1}#widgetic-root iframe{width:0px;height:0px}iframe.widgetic-composition {border: none;width: 100%;height: 100%;}iframe.widgetic-editor {width: 490px; height: 565px; border:none;overflow:hidden}",g=a("../config"),i=a("../utils/event"),e=a("../api/index"),j=a("../auth/iframe"),l=e.queue.steps,f=a("./../../../bower/aye/ayepromise.js"),d=function(){var a;return a=document.getElementsByTagName("body")[0],a.appendChild(this.el=document.createElement("div")),this.el.id="widgetic-root",j.setRoot(this),this},k=f.defer(),d.prototype.createProxy=function(){var a,b,c;return l.init&&(g.crossdomain?(b=document.createElement("iframe"),this.el.appendChild(b),a=function(){return d._done=null,clearTimeout(c),k.reject(new Error("Could not initialize cross-domain messaging iframe"))},c=setTimeout(a,1e4),d._done=function(){return e.setProxy(function(a){return b.contentWindow.postMessage(a,g.domain)}),clearTimeout(c),l.init(),d._done=l.init=null,k.resolve()},b.setAttribute("src",g.proxy)):(e.setProxy(function(a){return window.widgeticReceiver({origin:window.location.origin,data:a})}),l.init(),d._done=l.init=null,k.resolve())),k.promise},d.connect=function(){return"function"==typeof d._done?d._done():void 0},d.style=function(){var a,b;return a=document.getElementsByTagName("head")[0],a.appendChild(b=document.createElement("style")),b.textContent=h},b.exports=d},{"../api/index":13,"../auth/iframe":15,"../config":18,"../utils/event":24,"./../../../bower/aye/ayepromise.js":1}],23:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;m=a("./config"),g=a("./dom/root"),j=a("./api"),k=a("./auth"),n=a("./detect"),f=a("json3"),o=a("./utils/event"),v=a("./utils/ready"),d=a("./UI/composition"),e=a("./UI/editor"),h=a("./UI"),l=a("./../../bower/aye/ayepromise.js"),w=window,p=!1,u={a:j.request,e:j.response,i:g.connect,o:k.connect,d:d.apiReady,u:d.connect,ce:d.event,w:e.connect,ee:e.event,p:h.popup.receiver,r:k.retry,v:h.plugin.connect,ve:h.plugin.event,su:d.updateSize},r=""+m.lo.replace(/(http|https)\:/,"")+"|"+m.domain.replace(/(http|https)\:/,""),r=r.replace(/\./g,"\\."),r=new RegExp(r),window.widgeticReceiver=t=function(a){var b,c,d;if(r.test(a.origin)){b=a.data;try{if("string"!=typeof b)return;b=f.parse(b)}catch(e){return void(c=e)}try{return"function"==typeof u[d=b.t]?u[d](b,a):void 0}catch(e){return void(c=e)}}},i=function(){return"function"==typeof w.WidgeticAsyncInit&&w.WidgeticAsyncInit(),o.on(w,"message",t),n(w.location.href),g.style(),setTimeout(h.parse)},s=l.defer(),q=function(){var a,b=this;return p||(a=function(){return(b.root=new g).createProxy().then(function(){return s.resolve()}).fail(function(a){return s.reject(a)}),p=!0},document.getElementsByTagName("body")[0]?a():v(a)),s.promise},i.prototype.init=function(a,b){return q(),a&&b?(k.setAuthOptions(a,b),this):this},i.prototype.api=function(){var a;return a=arguments,q().then(function(){return j.apply(this,a)})},i.prototype.auth=function(){return k.apply(this,arguments)},i.prototype.auth.register=function(){return k.register.apply(this,arguments)},i.prototype.auth.status=function(){return j.getStatus.apply(this,arguments)},i.prototype.auth.token=function(){return j.accessToken.apply(this,arguments)},i.prototype.auth.disconnect=function(){return j.disconnect.apply(this,arguments)},i.prototype.JSON=f,i.prototype.Queue=j.queue,i.prototype.Aye=a("./../../bower/aye/ayepromise.js"),i.prototype.Event=o,i.prototype.GUID=a("./utils/guid"),i.prototype.pubsub=a("./../../bower/pubsub.js/src/pubsub.js"),i.prototype.require=a,i.prototype.UI=h,i.prototype.EVENTS=a("./constants/events"),i.prototype.VERSION="0.7.2",i.prototype.parse=n.parse,i.prototype.uxhr=a("./../../bower/uxhr/uxhr.js"),i.prototype.debug={timestamp:a("./utils/timestamp")},b.exports=i},{"./../../bower/aye/ayepromise.js":1,"./../../bower/pubsub.js/src/pubsub.js":2,"./../../bower/uxhr/uxhr.js":4,"./UI":9,"./UI/composition":7,"./UI/editor":8,"./api":13,"./auth":16,"./config":18,"./constants/events":19,"./detect":20,"./dom/root":22,"./utils/event":24,"./utils/guid":25,"./utils/ready":27,"./utils/timestamp":28,json3:5}],24:[function(a,b,c){var d,e;d="addEventListener",e="removeEventListener",b.exports={on:function(a,b,c,e){return null==e&&(e=!1),a[d]?a[d](b,c,e):a.attachEvent("on"+b,c)},off:function(a,b,c,d){return null==d&&(d=!1),a[e]?a[e](b,c,d):a.detachEvent("on"+b,c)}}},{}],25:[function(a,b,c){var d;d=function(){var a;return a=function(a){var b;return b=(Math.random().toString(16)+"000000000").substr(2,8),a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b},a()+a(!0)+a(!0)+a()},b.exports=d},{}],26:[function(a,b,c){var d,e,f;e=a("./../../../bower/queue-async/queue.js")(1),f={},d=function(a){return f.init=a},e.defer(d),e.steps=f,b.exports=e},{"./../../../bower/queue-async/queue.js":3}],27:[function(a,b,c){var d;d=function(a){var b;return"interactive"===(b=document.readyState)||"complete"===b?void a():document.addEventListener("DOMContentLoaded",a)},b.exports=d},{}],28:[function(a,b,c){var d;try{d=window.require("spine/utils/timestamp")}catch(e){d=function(){}}b.exports=d},{}]},{},[6]);